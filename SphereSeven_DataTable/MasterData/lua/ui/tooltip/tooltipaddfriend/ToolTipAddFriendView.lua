---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/4/12 17:40
---
local ToolTipAddFriendView = BaseClass("ToolTipAddFriendView",UIBaseView)
local base = UIBaseView
local this = ToolTipAddFriendView

local back_btn_path = "ReturnButton"
local confirm_btn_path = "ConfirmButton"
local title_text_path  = "TitleText"

local function OnClickConfirmButton(self)
    self.ctrl.CloseSelf();
    if self.model.data.callBack ~= nil then
        --self.msgIpt.text = LibStringSearch:Filter(self.msgIpt.text) -- 后面在加
        self.model.data.callBack(self.msgIpt.text)
    end
end

local function OnClickCancelButton(self)
    self.ctrl.CloseSelf();
    if self.model.data.cancelCallBack ~= nil then
        self.model.data.cancelCallBack();
    end
end

local function OnClickCloseButton(self)
    self.ctrl.CloseSelf();
end

function this.OnCreate(self)
    base.OnCreate(self);
    self.back_btn = self.rc:GetObject(back_btn_path);
    self.confirm_btn = self.rc:GetObject(confirm_btn_path);
    self.title_text = LangUtil.BindText(self.rc:GetObject(title_text_path))
    self.closeBut = self.rc:GetObject("CloseButton");
    self.hintText = self.rc:GetObject("HintText")
    self.msgIpt = self.rc:GetObject("MsgIpt"):GetComponent("InputField");
    UIUtil.AddBtnEvent(self.back_btn,function() OnClickCancelButton(self) end)
    UIUtil.AddBtnEvent(self.confirm_btn,function()OnClickConfirmButton(self) end)
    UIUtil.AddBtnEvent(self.closeBut,function()OnClickCloseButton(self) end)
    self.msgIpt.onValueChanged:AddListener(function ()
        if self.maxLen == nil then
            return
        end
        local over = false
        
        self.msgIpt.text, over = UIUtil.LimitString(self.msgIpt.text, tonumber(self.maxLen))
        if over then
            UIUtil.ToolTipFourth(string.gsub(LangUtil.GetSysLang(4030),"XX", self.maxLen))
        end
    end)
end

function this.OnLangCreate(self)
    LangUtil.BindText(self.back_btn.transform:Find("Text")).text = self.model.data.cancelTxt or LangUtil.GetSysLang(3017)
    LangUtil.BindText(self.confirm_btn.transform:Find("Text")).text = self.model.data.confirmTxt or LangUtil.GetSysLang(3018)
    self.title_text = LangUtil.BindText(self.rc:GetObject(title_text_path))
    LangUtil.BindText(self.msgIpt.transform:Find("Text"))
    LangUtil.BindText(self.hintText).text = LangUtil.GetSysLang(4036)
end

function this.OnEnable(self)
    base.OnEnable(self);
    self.msgIpt.text = LangUtil.GetSysLang(570)
    self.title_text.text = self.model.data.title
    self.maxLen = self.model.data.maxLength
end

function this.OnDestroy(self)
    self.back_btn = nil;
    self.confirm_btn = nil;
    self.title_text = nil;
    base.OnDestroy(self);
end

return this

