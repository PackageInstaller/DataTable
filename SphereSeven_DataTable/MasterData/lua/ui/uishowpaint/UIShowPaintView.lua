---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/5/24 16:58
---

local UIShowPaintView = BaseClass("UIShowPaintView",UIBaseView);
local base = UIBaseView
local this = UIShowPaintView

local initPos = Vector2.New(-388,-209)

local function OnDrag(self)
    
end


local function Init(self)
    local rectTransform = self.copyPaint:GetComponent("RectTransform")
    local rect = rectTransform.rect
    
    self.paint.image.sprite = self.copyPaint.sprite
    self.bgImg.sprite = self.copyBg.sprite
    self.paint.rectTransform.sizeDelta = Vector2.New(rect.width,rect.height)
    
    self.paint.rectTransform:DOLocalMoveX(0,0.3)
    coroutine.waitforseconds(0.3)
    self.view.enabled = true

    
end



function this.OnCreate(self)
    base.OnCreate(self);
    local paint = self.rc:GetObject("Paint")
    self.paint = {transform = paint.transform,image = paint:GetComponent("Image"),rectTransform = paint:GetComponent("RectTransform") }
    self.close = self.rc:GetObject("Close")
    self.bgImg =  self.rc:GetObject("Bg"):GetComponent("Image")
    self.view = self.rc:GetObject("Scroll View"):GetComponent("ScrollRect")
    self.content = self.rc:GetObject("Content"):GetComponent("RectTransform")
    
   -- EventTriggerListener.Get(self.gameObject).OnDrag = function(go) OnDrag(self)  end
    UIUtil.AddBtnEvent(self.close ,function()UIManager:GetInstance():CloseWindow(UIWindowNames.UIShowPaint)end,"Back")
end

function this.OnEnable(self)
    base.OnEnable(self)
   
    self:OnRefresh()
end



function this.OnRefresh(self) 
    self.copyPaint = self.model.paint
    self.copyBg = self.model.bg
    coroutine.start(function()
        self.view:DONormalizedPos(Vector2.New(1,1),0)
        self.view.enabled = false
        self.paint.rectTransform:DOLocalMove(initPos,0)
        Init(self)
    end)
    
end

function this.OnAddListener(self)
    base.OnAddListener(self)
end

function this.OnRemoveListener(self)
    base.OnRemoveListener(self);
end

function this.OnDisable(self)
    base.OnDisable(self)
    self.view:DONormalizedPos(Vector2.New(1,1),0)
    self.paint.rectTransform:DOLocalMove(initPos,0)
end

function this.OnDestroy(self)
    base.OnDestroy(self);
end

return this;

