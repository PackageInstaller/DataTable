---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/4/2 14:40
---

local UIComTopModel = BaseClass("UIComTopModel",UIBaseModel)
local base = UIBaseModel
maxLevel = 200
local GOLD_ID = tonumber(Z_Misc["GOLD_ID"].Value[1])
local FIGHT_SOUL_DECOMPOSE_SHOW_ITEM_ID = tonumber(Z_Misc["FIGHT_SOUL_DECOMPOSE_SHOW_ITEM_ID"].Value[1])
local DIAMOND_ID = tonumber(Z_Misc["DIAMOND_ID"].Value[1])
local FREE_DIAMOND_ID = tonumber(Z_Misc["FREE_DIAMOND_ID"].Value[1])
local STAR_STONE_ID = tonumber(Z_Misc["STAR_STONE_ID"].Value[1])


local function OnItemDataUpdate(self, updateIds, removeIds)
    self:OnRefresh()
    self:UIBroadcast(UIMessageNames.ON_ITEM_DATA_UPDATE, updateIds, removeIds)
end

local function OnCreate(self)
    base.OnCreate(self)
    self.gold = nil
    self.star_stone = nil
    self.star_sand = nil
end

local function OnEnable(self)
    base.OnEnable(self)
    self:OnRefresh()
end

local function OnRefresh(self)
    -- local player = Game.Scene.Player
    -- local gold = Game.Scene.Player:GetComponent("ItemComponent"):GetItem(GOLD_ID)
    -- if gold == nil then
    --     self.gold = 0
    -- else
    --     self.gold = gold.Amount
    -- end

    -- local starSand = Game.Scene.Player:GetComponent("ItemComponent"):GetItem(FIGHT_SOUL_DECOMPOSE_SHOW_ITEM_ID) 
    -- if starSand == nil then
    --     self.star_sand = 0
    -- else
    --     self.star_sand = starSand.Amount
    -- end

    self.gold = UIPublic.GetItemAmount(GOLD_ID)--player.Gold
    self.free_star_stone = UIPublic.GetItemAmount(FREE_DIAMOND_ID)--player.FreeStarStone
    self.star_sand = UIPublic.GetItemAmount(STAR_STONE_ID)--player.StarSand
    self.paid_star_stone = UIPublic.GetItemAmount(DIAMOND_ID)--player.PaidStarStone
end

local function OnAddListener(self)
    base.OnAddListener(self)
    self:AddDataListener(DataMessageNames.ON_ITEM_DATA_UPDATE, OnItemDataUpdate)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
    self:RemoveDataListener(DataMessageNames.ON_ITEM_DATA_UPDATE)
end

local function OnDisable(self)
    base.OnDisable(self)
    self.name = nil
    self.level = nil
    self.exp_value = nil
    self.exp = nil
    self.icon_name = nil
    self.gold = nil
    self.star_stone = nil
    self.star_sand = nil
end

local function OnDestroy(self) 
    base.OnDestroy(self)
end

UIComTopModel.OnCreate = OnCreate
UIComTopModel.OnEnable = OnEnable
UIComTopModel.OnRefresh = OnRefresh
UIComTopModel.OnAddListener = OnAddListener
UIComTopModel.OnRemoveListener = OnRemoveListener
UIComTopModel.OnDisable = OnDisable
UIComTopModel.OnDestroy = OnDestroy
--UIComTopModel.MoveComTop = MoveComTop

return UIComTopModel