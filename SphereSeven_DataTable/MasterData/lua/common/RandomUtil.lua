---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by daiyi.
--- DateTime: 2019/6/1 22:39
---
if ss == nil then 
    ss = {}
    math.randomseed(os.time())
end

---
--- warr = {0.1,0.3,0.2,0.4}
--- return warr的索引
---
function ss.WeightRandHit(warr)
    assert(#warr>0)
    local rarr = {}
    for i = 1, #warr do
        local re = 0
        for j = 1, i do
            re = re + warr[j]
        end
        rarr[i] = re
    end
    local r = math.random()*rarr[#rarr]
    for i = 1, #rarr do
        if r < rarr[i] then
            return i
        end
    end
end

---
--- r = 0.3
--- return true或false
--- 命中为true,未命中为false
---
function ss.IsRandHit(r)
    local warr = {r}
    if #warr == 1 then
        warr[2] = 1 - warr[1]
    end
    local wr = ss.WeightRandHit(warr)
    if wr == 1 then
        return true
    elseif wr == 2 then
        return false
    end
end

function ss.IsRandHitOnce(r, count)
    local random = 1 - CS.System.Math.Pow(1 - r, 1 / count)
    return ss.IsRandHit(random)
end

function ss.GetRandom(r, count) 
    return 1 - CS.System.Math.Pow(1 - r, 1 / count)
end

function ss.test()
    for i =1,10 do
        print(ss.IsRandHit(0.45))
    end
    print("==========================")
    for i =1,10 do
        print(ss.WeightRandHit({
            2/100,
            5/100,
            8/100,
            11/100,
            14/100,
            4/100,
            6/100,
            13/100,
            17/100,
            20/100
        }))
    end
end