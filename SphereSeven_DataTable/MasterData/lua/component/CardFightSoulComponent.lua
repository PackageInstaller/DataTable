---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by daiyi.
--- DateTime: 2019/4/12 22:55
---
local CardFightSoulComponent = BaseClass("CardFightSoulComponent", Component)
local base = Component

local MaxStar = 5

local function Equip(self,fightSoul)
    if (fightSoul ~= nil) then
        local star = fightSoul.Star
        if star > MaxStar then star = MaxStar end
        local attrAdd = (star - 1) * self.star_attr_add
        self.numeric_component:Inc(NumericType.MaxHpPct,attrAdd)
        self.numeric_component:Inc(NumericType.AtkPct,attrAdd)
        self.numeric_component:Inc(NumericType.DefPct,attrAdd)
        self.numeric_component:Inc(NumericType.SpeedPct,attrAdd)
    end
end

local function UnEquip(self,fightSoul)
    if (fightSoul ~= nil) then
        local star = fightSoul.Star
        if star > MaxStar then star = MaxStar end
        local attrAdd = (star - 1) * self.star_attr_add
        self.numeric_component:Dec(NumericType.MaxHpPct,attrAdd)
        self.numeric_component:Dec(NumericType.AtkPct,attrAdd)
        self.numeric_component:Dec(NumericType.DefPct,attrAdd)
        self.numeric_component:Dec(NumericType.SpeedPct,attrAdd)
    end
end

local function Awake(self)
    base.Awake(self)

    self.numeric_component = self.__entity:GetComponent("NumericComponent")

    local fightSoulComponent = Game.Scene.Player:GetComponent("FightSoulComponent")
    local entity = self.__entity;
    if not entity.IsSupport then
        self.FightSoul1 = fightSoulComponent:Get(entity.FightSoul1) --or self.__entity.FightSouls[self.__entity.FightSoul1];
        self.FightSoul2 = fightSoulComponent:Get(entity.FightSoul2) --or self.__entity.FightSouls[self.__entity.FightSoul2];
        self.FightSoul3 = fightSoulComponent:Get(entity.FightSoul3) --or self.__entity.FightSouls[self.__entity.FightSoul3];
    else
        self.FightSoul1 = entity.FightSouls[entity.FightSoul1];
        self.FightSoul2 = entity.FightSouls[entity.FightSoul2];
        self.FightSoul3 = entity.FightSouls[entity.FightSoul3];
    end

    self.star_attr_add = table.first(Z_PropAdd,function(v) return v.Name == "FightSoulStarAttrAdd" end).AttrAdd
   
    Equip(self,self.FightSoul1)
    Equip(self,self.FightSoul2)
    Equip(self,self.FightSoul3)
end

local function Equip1(self,fightSoul)
    if(fightSoul == nil)then
        return
    end
    self.__entity.FightSoul1 = fightSoul.Id
    self.FightSoul1 = fightSoul
    Equip(self,fightSoul)
end

local function UnEquip1(self)
    UnEquip(self,self.FightSoul1)
    self.__entity.FightSoul1 = 0
    self.FightSoul1 = nil
end

local function Equip2(self,fightSoul)
    if(fightSoul == nil)then
        return
    end
    self.__entity.FightSoul2 = fightSoul.Id
    self.FightSoul2 = fightSoul
    Equip(self,fightSoul)
end

local function UnEquip2(self)
    UnEquip(self,self.FightSoul2)
    self.__entity.FightSoul2 = 0
    self.FightSoul2 = nil
end

local function Equip3(self,fightSoul)
    if(fightSoul == nil)then
        return
    end
    self.__entity.FightSoul3 = fightSoul.Id
    self.FightSoul3 = fightSoul
    Equip(self,fightSoul)
end

local function UnEquip3(self)
    UnEquip(self,self.FightSoul3)
    self.__entity.FightSoul3 = 0
    self.FightSoul3 = nil
end

local function PreviewEquip(self,fightSoul)
    Equip(self,fightSoul)
end

local function PreviewUnEquip(self,fightSoul)
    UnEquip(self,fightSoul)
end

local function Dispose(self)
    base.Dispose(self)
end

CardFightSoulComponent.Awake = Awake
CardFightSoulComponent.Equip1 = Equip1
CardFightSoulComponent.Equip2 = Equip2
CardFightSoulComponent.Equip3 = Equip3
CardFightSoulComponent.UnEquip1 = UnEquip1
CardFightSoulComponent.UnEquip2 = UnEquip2
CardFightSoulComponent.UnEquip3 = UnEquip3
CardFightSoulComponent.PreviewEquip = PreviewEquip
CardFightSoulComponent.PreviewUnEquip = PreviewUnEquip
CardFightSoulComponent.Dispose = Dispose

return CardFightSoulComponent