---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by daiyi.
--- DateTime: 2019/6/11 15:49
---
local UIBuffDetailsView = BaseClass("UIBuffDetailsView",UIBaseView)
local this = UIBuffDetailsView
local base = UIBaseView

local buffDetailPf = PathUtil.Path_UIBattleCommonBuffGlancePrefab.."BuffDetail.prefab"

function this.OnCreate(self)
    base.OnCreate(self)
    
    self.typeTgl = self.rc:GetObject("Type"):GetComponent("Toggle")
    self.continueBuffTgl = self.rc:GetObject("ContinueBuff"):GetComponent("Toggle")
    self.onceTgl = self.rc:GetObject("OnceBuff"):GetComponent("Toggle")
    self.continueDeBuffTgl = self.rc:GetObject("ContinueDeBuff"):GetComponent("Toggle")
    self.specialTgl = self.rc:GetObject("SpecialBuff"):GetComponent("Toggle")
    self.bossTgl = self.rc:GetObject("BossBuff"):GetComponent("Toggle")

    local eventBg = self.rc:GetObject("EventBg")
    EventTriggerListener.Get(eventBg).onLuaClick = function() UIManager:GetInstance():CloseWindow(UIWindowNames.UIBuffDetails) end
    
    self.closeBtn = self.rc:GetObject("CloseBtn"):GetComponent("Button")
    UIUtil.AddBtnEvent(self.closeBtn, function(go)
        UIManager:GetInstance():CloseWindow(UIWindowNames.UIBuffDetails)
    end)
    
    self.buff1Content = self.rc:GetObject("Buff1Content")
    self.buff2Content = self.rc:GetObject("Buff2Content")
    self.buff3Content = self.rc:GetObject("Buff3Content")
    self.buff4Content = self.rc:GetObject("Buff4Content")
    self.buff5Content = self.rc:GetObject("Buff5Content")
    self.typeContent = self.rc:GetObject("TypeContent").transform

    self.typeScroll = self.rc:GetObject("TypeScroll")
    self.buff1Scroll = self.rc:GetObject("Buff1Scroll")
    self.buff2Scroll = self.rc:GetObject("Buff2Scroll")
    self.buff3Scroll = self.rc:GetObject("Buff3Scroll")
    self.buff4Scroll = self.rc:GetObject("Buff4Scroll")
    self.buff5Scroll = self.rc:GetObject("Buff5Scroll")

    EventTriggerListener.Get(self.rc:GetObject("Type")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    EventTriggerListener.Get(self.rc:GetObject("ContinueBuff")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    EventTriggerListener.Get(self.rc:GetObject("OnceBuff")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    EventTriggerListener.Get(self.rc:GetObject("ContinueDeBuff")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    EventTriggerListener.Get(self.rc:GetObject("SpecialBuff")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    EventTriggerListener.Get(self.rc:GetObject("BossBuff")).onLuaClick = function()
        Game.Scene:GetComponent("SoundComponent"):PlayButtonSound()
        self:ShowBuff()
    end
    
    self:Create()
end

function this.OnLangCreate(self)
    LangUtil.BindText(self.rc:GetObject("TitleText")).text =  LangUtil.GetSysLang(3020)
    LangUtil.BindText(self.rc:GetObject("Text1")).text = LangUtil.GetSysLang(3025)
    LangUtil.BindText(self.rc:GetObject("Text2")).text = LangUtil.GetSysLang(3026)
    LangUtil.BindText(self.rc:GetObject("Text3")).text = LangUtil.GetSysLang(3027)
    LangUtil.BindText(self.rc:GetObject("Text4")).text = LangUtil.GetSysLang(3028)
    LangUtil.BindText(self.rc:GetObject("Text5")).text = LangUtil.GetSysLang(3029)
    LangUtil.BindText(self.rc:GetObject("Text6")).text = LangUtil.GetSysLang(3079)

    local TitleStr = {3026, 3027, 3028, 3029, 3079}
    local DescStr = {3030, 3031,3032, 3033, 3080}
    for i = 0, self.typeContent.childCount - 1 do
        local transform = self.typeContent:GetChild(i)
        LangUtil.BindText(transform:Find("Desc1")).text = LangUtil.GetSysLang(DescStr[i + 1])
        LangUtil.BindText(transform:Find("Title/Title1")).text = LangUtil.GetSysLang(TitleStr[i + 1])
    end

end

function this.Create(self)
    coroutine.start(function ()
        self:ShowBuff()
        for k, v in table.pairsByKeys(Z_Buff) do
            if v.IsShow == 1 then
                local buffDetail = GameObjectPool:GetInstance():CoGetGameObjectAsync(buffDetailPf)
                if v.Kind == 1 then
                    buffDetail.transform:SetParent(self.buff1Content.transform, false)
                elseif v.Kind == 2 then
                    buffDetail.transform:SetParent(self.buff2Content.transform, false)
                elseif v.Kind == 3 then
                    buffDetail.transform:SetParent(self.buff3Content.transform, false)
                elseif v.Kind == 4 then
                    buffDetail.transform:SetParent(self.buff4Content.transform, false)
                elseif v.Kind == 5 then
                    buffDetail.transform:SetParent(self.buff5Content.transform, false)
                end
                buffDetail:SetActive(true)
                LangUtil.BindText(buffDetail.transform:Find("Name")).text = LangUtil.GetConfLang(v, "Name")
                LangUtil.BindText(buffDetail.transform:Find("Desc")).text = LangUtil.GetConfLang(v, "Desc")
            end
        end
    end)
end

function this.TextColor(self, isOn, text)
    if isOn then
        text.color = Color.New(1,1,1,1)
    else
        text.color = Color.New(84 / 255,110 / 255,154 / 255,1)
    end
end

function this.ShowBuff(self)
    self:TextColor(self.typeTgl.isOn, self.typeTgl.transform:Find("Text"):GetComponent("Text"))
    self:TextColor(self.continueBuffTgl.isOn, self.continueBuffTgl.transform:Find("Text"):GetComponent("Text"))
    self:TextColor(self.onceTgl.isOn, self.onceTgl.transform:Find("Text"):GetComponent("Text"))
    self:TextColor(self.continueDeBuffTgl.isOn, self.continueDeBuffTgl.transform:Find("Text"):GetComponent("Text"))
    self:TextColor(self.specialTgl.isOn, self.specialTgl.transform:Find("Text"):GetComponent("Text"))
    self:TextColor(self.bossTgl.isOn, self.bossTgl.transform:Find("Text"):GetComponent("Text"))

    self.typeScroll:SetActive(self.typeTgl.isOn)
    self.buff1Scroll:SetActive(self.continueBuffTgl.isOn)
    self.buff2Scroll:SetActive(self.onceTgl.isOn)
    self.buff3Scroll:SetActive(self.continueDeBuffTgl.isOn)
    self.buff4Scroll:SetActive(self.specialTgl.isOn)
    self.buff5Scroll:SetActive(self.bossTgl.isOn)
end

function this.OnEnable(self)
    base.OnEnable(self)
    self.buff1Content.transform:DOLocalMoveY(0,0)
    self.buff2Content.transform:DOLocalMoveY(0,0)
    self.buff3Content.transform:DOLocalMoveY(0,0)
    self.buff4Content.transform:DOLocalMoveY(0,0)
    self.buff5Content.transform:DOLocalMoveY(0,0)
    
end

function this.OnDisable(self)
    base.OnDisable(self)
end

function this.OnDestroy(self)
    base.OnDestroy(self)
end

return this