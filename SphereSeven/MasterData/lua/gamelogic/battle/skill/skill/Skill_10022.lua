---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/5/28 11:12
--- 君临天下
---每回合开始时自身攻击力、暴击伤害＋10%，最多叠加50%"
--自身成功击杀敌人时重置自身所有技能的冷却时间",
--自身使用觉醒技（技能3）后自身获得神行、无双效果持续2回合

local Skill_10022 = BaseClass("Skill_10022",Skill)
local base = Skill

local function __init(self)
end

local function OnUseActiveSkill(self, targetUnit)
    local result = ActiveSkillResult.New()
    if targetUnit == self.SrcUnit then
        return result
    end

    local damageScale = self.Params[1] / 100
    local atk = self.__snc:Get(NumericType.Atk)
    local damageNum = atk * damageScale / self.MultistageNum
    result.FeixiaoDamage = {
        Type = BattleDamageType.Physical,
        Value = damageNum
    }

    local probability = self.Params[2]

    if BattleUtil.IsPctProbHit(probability) then
        table.insert(result.Buffs, ActiveSkillBuff.New(BattleBuffType.Freeze, self.Params[3]))
    end

    return result
end

local function OnAtkEnd(self)
    base.OnAtkEnd(self)

    if self.__bc.CurActSkill ~= self then
        return
    end

    if table.any(self.TargetUnits, function (targetUnit) return targetUnit:GetComponent("BuffComponent"):HasBuffId(BattleBuffType.Freeze) end) then
        self.SrcUnit:GetComponent("BattleUnitComponent"):ChangeActValue(self.Params[4])
    end
end


Skill_10022.__init = __init
Skill_10022.OnUseActiveSkill = OnUseActiveSkill
Skill_10022.OnAtkEnd = OnAtkEnd

return Skill_10022