---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/4/2 14:40
---

local UIComoTopView = BaseClass("UIComoTopView",UIBaseView);
local base = UIBaseView;

local icon_image_path = "BackGround/AvatarMask/PlayerAvatar";
local test_bag_btn_path = "BackGround/BagButton";
local test_shop_btn_path = "BackGround/TestShopButton";
local name_text_path = "BackGround/Name/NameText";
local level_text_path = "BackGround/Level/LevelText";
local exp_slider_path = "BackGround/Exp";
local exp_text_path = "BackGround/Exp/ExpText";
local gold_text_path = "BackGround/Gold/GoldText";
local gold_btn_path = "BackGround/Gold/GoldButton";
local star_stone_text_path = "BackGround/StarStone/StarStoneText";
local star_stone_btn_path = "BackGround/StarStone/StarStoneButton";
local star_sand_text_path = "BackGround/StarSand/StarSandText";
local star_sand_btn_path = "BackGround/StarSand/StarSandButton";

local exp_str = "EXP:";
local level_str = "LV:";

local function OnFreshIconInfo(self)
    self.icon_image:SetSpriteName(self.model.icon_name);
end

local function OnFreshLevelInfo(self)
    self.level_text:SetText(level_str..self.model.level);
    self.exp_slider:SetValue(self.model.expValue);
    self.exp_text:SetText(exp_str..self.model.exp);
end

local function OnFreshNameInfo(self)
    self.name_text:SetText(self.model.name);
end

local function OnFreshGoldInfo(self)
    self.gold_text:SetText(self.model.gold);
end

local function OnFreshStarStoneInfo(self)
    self.star_stone_text:SetText(self.model.star_stone);
end

local function OnFreshStarSandInfo(self)
    self.star_sand_text:SetText(self.model.star_sand);
end



local function OnCreate(self)
    base.OnCreate(self);
    self.icon_image = self:AddComponent(UIImage,icon_image_path);
    self.exp_slider = self:AddComponent(UISlider,exp_slider_path);
    self.name_text = self:AddComponent(UIText,name_text_path);
    self.level_text = self:AddComponent(UIText,level_text_path);
    self.exp_text = self:AddComponent(UIText,exp_text_path);
    self.gold_text = self:AddComponent(UIText,gold_text_path);
    self.star_stone_text = self:AddComponent(UIText,star_stone_text_path);
    self.star_sand_text = self:AddComponent(UIText,star_sand_text_path);
    
    self.test_bag_btn = self:AddComponent(UIButton,test_bag_btn_path);
    self.test_shop_btn = self:AddComponent(UIButton,test_shop_btn_path);
    self.gold_btn = self:AddComponent(UIButton,gold_btn_path);
    self.star_stone_btn = self:AddComponent(UIButton,star_stone_btn_path);
    self.star_sand_btn = self:AddComponent(UIButton,star_sand_btn_path);

    self.test_bag_btn:SetOnClick(self,self.ctrl.OpenTestBagWindow);
    self.test_shop_btn:SetOnClick(self,self.ctrl.OpenTestShopWindow);
    self.gold_btn:SetOnClick(self,self.ctrl.OpenRechargeGoldWindow);
    self.star_stone_btn:SetOnClick(self,self.ctrl.OpenRechargeStarStoneWindow);
    self.star_sand_btn:SetOnClick(self,self.ctrl.OpenRechargeStarSandWindow);
    
    self.rectTransform = self.gameObject:GetComponent("RectTransform");
    self.rectTransform.offsetMin = Vector2.zero;
    self.rectTransform.offsetMax = Vector2.zero;
end

local function OnEnable(self)
    base.OnEnable(self);
    self:OnRefresh();
end

local function OnRefresh(self)
    self.name_text:SetText(self.model.name)
    self.level_text:SetText(level_str..self.model.level)
    self.exp_text:SetText(exp_str..self.model.exp)
    self.gold_text:SetText(self.model.gold)
    self.star_stone_text:SetText(self.model.star_stone)
    self.star_sand_text:SetText(self.model.star_sand)
    --self.icon_image:SetSpriteName(self.model.icon_name);
    self.exp_slider:SetValue(self.model.exp_value);
end

local function OnAddListener(self)
    base.OnAddListener(self);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_ICON_CHG, OnFreshIconInfo);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_NAME_CHG, OnFreshNameInfo);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_LEVEL_CHG, OnFreshLevelInfo);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_GOLD_CHG, OnFreshGoldInfo);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_STONE_CHG, OnFreshStarStoneInfo);
    self:AddUIListener(UIMessageNames.UICOMTop_ON_PLAYER_SAND_CHG, OnFreshStarSandInfo);
    
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_ICON_CHG, OnFreshIconInfo);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_NAME_CHG, OnFreshNameInfo);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_LEVEL_CHG, OnFreshLevelInfo);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_GOLD_CHG, OnFreshGoldInfo);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_STONE_CHG, OnFreshStarStoneInfo);
    self:RemoveUIListener(UIMessageNames.UICOMTop_ON_PLAYER_SAND_CHG, OnFreshStarSandInfo);
end

local function OnDestroy(self)
    self.icon_image = nil;
    self.exp_slider = nil;
    self.name_text = nil;
    self.level_text = nil;
    self.exp_text = nil;
    self.gold_text = nil;
    self.star_stone_text = nil;
    self.star_sand_text = nil;
    self.test_bag_btn = nil;
    self.test_shop_btn = nil;
    self.gold_btn = nil;
    self.star_stone_btn = nil;
    self.star_sand_btn = nil;
    base.OnDestroy(self);
end

UIComoTopView.OnCreate = OnCreate;
UIComoTopView.OnEnable = OnEnable;
UIComoTopView.OnRefresh = OnRefresh;
UIComoTopView.OnAddListener = OnAddListener;
UIComoTopView.OnRemoveListener = OnRemoveListener;
UIComoTopView.OnDestroy = OnDestroy;

return UIComoTopView