---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/5/24 16:58
---

local UISummonTipView = BaseClass("UISummonTipView",UIBaseView);
local base = UIBaseView
local this = UISummonTipView


local function OnClickConfirmButton(self)
    self.model.data.callBack(self.currencyId)
    UIManager:GetInstance():CloseWindow(UIWindowNames.UISummonTip)
end

local function OnClickCancelButton(self)
    UIManager:GetInstance():CloseWindow(UIWindowNames.UISummonTip)
end


local function OnClickCurrencyButton(self,id)
    self.currencyId = id
    if id == 1 then
        self.msgTxt.text = string.gsub(LangUtil.GetSysLang(2047),"X","<color=#FFF779>"..self.model.data.price.."</color>)" )
    else
        self.msgTxt.text =  string.gsub(LangUtil.GetSysLang(2048),"X","<color=#FFF779>"..self.model.data.price.."</color>)" )
    end

    for k,v in pairs(self.currencys) do
        local transform = v.transform
        local active = transform:Find("Active").gameObject
        active:SetActive(id == k)
    end
end


local function CurrencyCreate(self)
    for k,v in pairs(self.currencys) do
        local transform = v.transform
        local avatar = transform:Find("Image")
        UIUtil.AddBtnEvent(avatar,function() OnClickCurrencyButton(self,k)  end)
    end
end


local function InitCurrency(self)
    for k,v in pairs(self.currencys) do
        local transform = v.transform
        local holdTxt = transform:Find("HoldTxt"):GetComponent("Text")
        if k == 1 then holdTxt.text = LangUtil.GetSysLang(354)" "..Game.Scene.Player.PaidStarStone end
        if k == 2 then holdTxt.text = LangUtil.GetSysLang(354)" "..(Game.Scene.Player.FreeStarStone)end
    end
end

function this.OnCreate(self)
    base.OnCreate(self);
    local confirmBtn = self.rc:GetObject("ConfirmButton")
    local returnBtn = self.rc:GetObject("ReturnButton")
    local starStone = self.rc:GetObject("StarStone")
    local starLightStone = self.rc:GetObject("StarLightStone")
    self.msgTxt = self.rc:GetObject("Msg"):GetComponent("Text")
    self.currencys = {starLightStone,starStone}
    CurrencyCreate(self)
    UIUtil.AddBtnEvent(confirmBtn,function() OnClickConfirmButton(self) end)
    UIUtil.AddBtnEvent(returnBtn,function() OnClickCancelButton(self) end)
end

function this.OnEnable(self)
    base.OnEnable(self)
    self.currencyId = 1 -- 1星光石  2 星石
    self.msgTxt.text =  string.gsub(LangUtil.GetSysLang(2047),"X","<color=#FFF779>"..self.model.data.price.."</color>)" )
    InitCurrency(self)
    self:OnRefresh();
end



function this.OnRefresh(self)
    OnClickCurrencyButton(self,2)
end


function this.OnAddListener(self)
    base.OnAddListener(self)
    
end

function this.OnRemoveListener(self)
    base.OnRemoveListener(self);
    
end

function this.OnDisable(self)
    base.OnDisable(self);
end

function this.OnDestroy(self)
    base.OnDestroy(self);
end

return this;

