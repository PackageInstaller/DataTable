---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/4/12 17:40
---
local ToolTipBuffDetailView = BaseClass("ToolTipBuffDetailView",UIBaseView)
local base = UIBaseView
local this = ToolTipBuffDetailView

function this.OnCreate(self)
    base.OnCreate(self)
    self.eventBg = self.rc:GetObject("EventBg")
    self.content = self.rc:GetObject("Content")

    UIUtil.AddBtnEvent(self.eventBg,function()self.ctrl:CloseSelf()end,"Back")
    
end

function this.OnLangCreate(self)
end

function this.OnEnable(self)
    base.OnEnable(self)
    self:OnRefresh()
end

function this.OnRefresh(self)
    for i = 1, 16 do
        local buffItem = self.content.transform:Find("DescriptionObj" .. i)
        buffItem.gameObject:SetActive(false)
    end
    local buffList = self.model.buffList
    if buffList ~= nil then
        for index, buffInfo in ipairs(buffList) do
            local buff = Z_Buff[buffInfo.BuffId]
            if buff ~= nil then
                local buffItem = self.content.transform:Find("DescriptionObj" .. index)
                buffItem.gameObject:SetActive(true)
                local buffIcon = buffItem.transform:Find("BG/BuffImage"):GetComponent("Image")
                local buffName = buffItem.transform:Find("BuffName"):GetComponent("Text")
                local buffDesc = buffItem.transform:Find("DescriptionText"):GetComponent("Text")
                buffName.text = "[" .. buff.Name .. "]"
                buffDesc.text = buff.Desc
                coroutine.start(function()
                    buffIcon.sprite = AtlasManager:GetInstance():CoLoadImageAsync("UI/Atlas/LittleBuff/" .. buff.LittleIcon .. ".png")
                 end)
            end
        end
    end

    coroutine.start(function()
       coroutine.waitforframes(4)
       LayoutRebuilder.ForceRebuildLayoutImmediate(self.content:GetComponent("RectTransform"))
    end)
end

function this.OnAddListener(self)
    base.OnAddListener(self)
end

function this.OnRemoveListener(self)
    base.OnRemoveListener(self)
end

function this.OnDisable(self)
    base.OnDisable(self)
end

function this.OnDestroy(self)
    base.OnDestroy(self)
end

return this

