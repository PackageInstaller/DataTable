---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2019/4/3 13:59
---

local UIStoryListModel = BaseClass("UIStoryListModel",UIBaseModel)
local base = UIBaseModel;
local this  = UIStoryListModel


local function OnCreate(self)
    base.OnCreate(self);

end

local function OnEnable(self, data)
    base.OnEnable(self);
    self.data = data

    self:OnRefresh();
end

function this.OnRefresh(self)
    local storyComponent = Game.Scene.Player:GetComponent("StoryComponent");
    if self.data.levelType == LevelType.LevelTypeGameEvent then
        self.data.sectionList = table.choose(Z_GameEventsLevel, function(_, v)
            return v.ChapterId == self.data.ChapterId and not string.IsNullOrEmpty(v.StoryId) and not string.startswith(v.Number, "H")
        end)
    else
        self.data.sectionList = table.choose(Z_StorySection, function(_, v)
            return v.ChapterId == self.data.ChapterId and not string.IsNullOrEmpty(v.StoryId) and not string.startswith(v.Number, "H")
        end)
    end

    self.data.storyId = storyComponent:GetCompletedSection(self.data.ChapterId, self.data.levelType)[1]
end

local function OnAddListener(self)
    base.OnAddListener(self);
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self);
end

local function OnDisable(self)
    base.OnDisable(self);
end

local function OnDestroy(self)
    base.OnDestroy(self);
end

UIStoryListModel.OnCreate = OnCreate
UIStoryListModel.OnEnable = OnEnable
UIStoryListModel.OnAddListener = OnAddListener
UIStoryListModel.OnRemoveListener = OnRemoveListener
UIStoryListModel.OnDisable = OnDisable
UIStoryListModel.OnDestroy = OnDestroy

return UIStoryListModel